<?xml version="1.0" encoding="UTF-8"?>

<?import com.jfoenix.controls.JFXButton?>
<?import com.jfoenix.controls.JFXComboBox?>
<?import com.jfoenix.controls.JFXToggleButton?>
<?import javafx.geometry.Insets?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.PasswordField?>
<?import javafx.scene.control.TableColumn?>
<?import javafx.scene.control.TableView?>
<?import javafx.scene.control.TextField?>
<?import javafx.scene.image.Image?>
<?import javafx.scene.image.ImageView?>
<?import javafx.scene.layout.BorderPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.StackPane?>
<?import javafx.scene.layout.VBox?>

<BorderPane fx:id="rootScene" prefHeight="720.0" prefWidth="1280.0" stylesheets="@../css/styles.css" xmlns="http://javafx.com/javafx/23.0.1" xmlns:fx="http://javafx.com/fxml/1" fx:controller="org.example.zyropos.CashierController">
    <!-- Left Sidebar -->
    <left>
       <VBox fx:id="menuBar" prefWidth="240.0" styleClass="sidebar">
          <children>
             <!-- Logo Area -->
             <VBox alignment="CENTER" spacing="10" style="-fx-padding: 20 0 30 0;">
                 <ImageView fitHeight="40.0" fitWidth="40.0" preserveRatio="true">
                    <image>
                       <Image url="@../../../../assets/ZyroPOS2.png" />
                    </image>
                 </ImageView>
                 <Label text="Cashier" styleClass="h3" style="-fx-text-fill: white;"/>
             </VBox>
 
             <!-- Navigation -->
             <VBox spacing="5" VBox.vgrow="ALWAYS">
                 <JFXButton fx:id="btnDashboard" onAction="#showDashboard" prefWidth="Infinity" styleClass="nav-button" text="Dashboard" graphicTextGap="15">
                    <graphic>
                       <ImageView fitHeight="20.0" fitWidth="20.0" preserveRatio="true">
                          <Image url="@../../../../assets/home.png" />
                       </ImageView>
                    </graphic>
                 </JFXButton>

                 <JFXButton fx:id="btnViewProducts" onAction="#displayVP" prefWidth="Infinity" styleClass="nav-button" text="View Products" graphicTextGap="15">
                    <graphic>
                       <ImageView fitHeight="20.0" fitWidth="20.0" preserveRatio="true">
                          <Image url="@../../../../assets/view.png" />
                       </ImageView>
                    </graphic>
                 </JFXButton>
 
                 <JFXButton fx:id="btnViewCart" onAction="#dislayVC" prefWidth="Infinity" styleClass="nav-button" text="View Cart" graphicTextGap="15">
                    <graphic>
                       <ImageView fitHeight="20.0" fitWidth="20.0" preserveRatio="true">
                          <Image url="@../../../../assets/view.png" />
                       </ImageView>
                    </graphic>
                 </JFXButton>
 
                 <JFXButton fx:id="btnCP" onAction="#displayCP" prefWidth="Infinity" styleClass="nav-button" text="Change Password" graphicTextGap="15">
                    <graphic>
                       <ImageView fitHeight="20.0" fitWidth="20.0" preserveRatio="true">
                          <Image url="@../../../../assets/changePassword.png" />
                       </ImageView>
                    </graphic>
                 </JFXButton>
             </VBox>
             
             <!-- Bottom Actions -->
             <JFXButton fx:id="btnLogout" onAction="#handleLogout" prefWidth="Infinity" styleClass="nav-button" text="Logout" graphicTextGap="15" style="-fx-text-fill: #ef4444;">
                <graphic>
                   <ImageView fitHeight="20.0" fitWidth="20.0" preserveRatio="true">
                      <Image url="@../../../../assets/SuperAdmin/logout.png" />
                   </ImageView>
                </graphic>
             </JFXButton>
          </children>
       </VBox>
    </left>
 
    <!-- Main Content -->
    <center>
       <StackPane style="-fx-background-color: -fx-background; -fx-padding: 30;">
          <children>
             <!-- Welcome / Hero -->
              <Label fx:id="lblPerson" text="Welcome, Cashier" styleClass="h2" StackPane.alignment="TOP_LEFT" visible="false"/> <!-- Hidden in favor of Dashboard -->
          
             <!-- Dashboard Pane -->
             <VBox fx:id="dashboardPane" spacing="20" styleClass="dashboard-container">
                 <Label text="Overview" styleClass="h2"/>
                 <HBox spacing="20">
                     <!-- Metric Cards -->
                     <VBox styleClass="metric-card" HBox.hgrow="ALWAYS">
                         <Label text="Today's Sales" styleClass="metric-title"/>
                         <Label fx:id="lblTodaySales" text="0.00" styleClass="metric-value"/>
                         <Label text="+0% from yesterday" styleClass="metric-subtitle"/>
                     </VBox>
                     <VBox styleClass="metric-card" HBox.hgrow="ALWAYS">
                         <Label text="Transactions" styleClass="metric-title"/>
                         <Label fx:id="lblTransactionCount" text="0" styleClass="metric-value"/>
                         <Label text="Processed today" styleClass="metric-subtitle"/>
                     </VBox>
                     <VBox styleClass="metric-card" HBox.hgrow="ALWAYS">
                         <Label text="Products Sold" styleClass="metric-title"/>
                         <Label fx:id="lblProductsSold" text="0" styleClass="metric-value"/>
                         <Label text="Items moved" styleClass="metric-subtitle"/>
                     </VBox>
                 </HBox>
                 
                 <!-- Recent Transactions Section -->
                 <VBox spacing="10" VBox.vgrow="ALWAYS">
                     <Label text="Recent Transactions" styleClass="h3"/>
                     <TableView fx:id="tblRecentTransactions" VBox.vgrow="ALWAYS">
                        <columns>
                           <TableColumn fx:id="colSaleID" text="Transaction ID" prefWidth="100"/>
                           <TableColumn fx:id="colAmount" text="Amount" prefWidth="100"/>
                           <TableColumn fx:id="colDate" text="Time" prefWidth="150"/>
                           <TableColumn fx:id="colCashier" text="Cashier" prefWidth="150"/>
                        </columns>
                        <columnResizePolicy>
                           <TableView fx:constant="CONSTRAINED_RESIZE_POLICY" />
                        </columnResizePolicy>
                     </TableView>
                 </VBox>
             </VBox>

             <!-- View Products Pane -->
             <BorderPane fx:id="vpPane" visible="false" styleClass="card">
                <top>
                    <VBox spacing="15" style="-fx-padding: 0 0 20 0;">
                        <HBox alignment="CENTER_LEFT">
                             <VBox>
                                 <Label text="Product Catalog" styleClass="h3"/>
                                 <Label text="Browse and search inventory." styleClass="text-secondary"/>
                             </VBox>
                        </HBox>
                        
                        <HBox spacing="10" alignment="CENTER_LEFT" style="-fx-background-color: #f9fafb; -fx-padding: 10; -fx-background-radius: 5;">
                             <JFXComboBox fx:id="cmbVPSearchColumn" promptText="Search By" prefWidth="150" style="-fx-background-color: white;"/>
                             <TextField fx:id="tfVPSearchVal" promptText="Search term..." HBox.hgrow="ALWAYS" styleClass="input-field"/>
                             <JFXButton fx:id="btnVPSearch" onAction="#searchProducts" text="Search" styleClass="btn-primary" style="-fx-cursor: hand;"/>
                             <JFXButton fx:id="btnVPCart" onAction="#addToCart" text="Add to Cart" styleClass="btn-success" style="-fx-background-color: #22c55e; -fx-text-fill: white; -fx-cursor: hand;"/>
                        </HBox>
                    </VBox>
                </top>
                <center>
                   <TableView fx:id="tblProducts">
                      <columns>
                         <TableColumn fx:id="vpID" text="ID" prefWidth="50" />
                         <TableColumn fx:id="vpName" text="Name" />
                         <TableColumn fx:id="vpCategory" text="Category" />
                         <TableColumn fx:id="vpSalePrice" text="Price" />
                         <TableColumn fx:id="vpUnitPrice" text="Unit Price" visible="false"/> <!-- Hidden for cashier? keeping just in case -->
                         <TableColumn fx:id="vpCartonPrice" text="Carton Price" visible="false"/>
                         <TableColumn fx:id="vpQuantity" text="Stock" />
                      </columns>
                      <columnResizePolicy>
                         <TableView fx:constant="CONSTRAINED_RESIZE_POLICY" />
                      </columnResizePolicy>
                   </TableView>
                </center>
             </BorderPane>
 
             <!-- View Cart Pane -->
             <BorderPane fx:id="vcPane" visible="false" styleClass="card">
                <top>
                    <VBox spacing="15" style="-fx-padding: 0 0 20 0;">
                        <HBox alignment="CENTER_LEFT">
                             <VBox>
                                 <Label text="Shopping Cart" styleClass="h3"/>
                                 <Label text="Review items before checkout." styleClass="text-secondary"/>
                             </VBox>
                        </HBox>
                    </VBox>
                </top>
                <center>
                   <TableView fx:id="tblCart" editable="true">
                      <columns>
                         <TableColumn fx:id="vcID" text="ID" prefWidth="50" editable="false"/>
                         <TableColumn fx:id="vcName" text="Name" editable="false"/>
                         <TableColumn fx:id="vcCategory" text="Category" editable="false"/>
                         <TableColumn fx:id="vcSalePrice" text="Price" editable="false"/>
                         <TableColumn fx:id="vcUnitPrice" text="Unit Price" visible="false" editable="false"/>
                         <TableColumn fx:id="vcCartonPrice" text="Carton Price" visible="false" editable="false"/>
                         <TableColumn fx:id="vcQuantity" text="Quantity" />
                      </columns>
                      <columnResizePolicy>
                         <TableView fx:constant="CONSTRAINED_RESIZE_POLICY" />
                      </columnResizePolicy>
                   </TableView>
                </center>
                <bottom>
                    <HBox spacing="20" alignment="CENTER_RIGHT" style="-fx-padding: 20 0 0 0;">
                        <JFXButton fx:id="btnVCRemove" onAction="#removeCartItem" text="Remove Selected" styleClass="btn-danger" style="-fx-cursor: hand;"/>
                        <JFXButton fx:id="btnVCGenerateBill" onAction="#generateBill" text="Complete Sale" styleClass="btn-success" style="-fx-cursor: hand;"/>
                    </HBox>
                </bottom>
             </BorderPane>
 
             <!-- Change Password Pane -->
             <VBox fx:id="cpPane" styleClass="card" visible="false" spacing="20" maxWidth="400" maxHeight="450">
                 <Label text="Change Password" styleClass="h2"/>
                 
                 <VBox spacing="5">
                      <Label text="Old Password" styleClass="text-secondary"/>
                      <PasswordField promptText="Enter Current Password" />
                 </VBox>
                 
                 <VBox spacing="5">
                      <Label text="New Password" styleClass="text-secondary"/>
                      <PasswordField promptText="Enter New Password" />
                 </VBox>
                 
                 <VBox spacing="5">
                      <Label text="Confirm Password" styleClass="text-secondary"/>
                      <PasswordField promptText="Re-enter New Password" />
                 </VBox>
                 
                 <JFXToggleButton fx:id="btnToggle" text="Show Passwords" />
                 <JFXButton text="Update Password" styleClass="btn-primary" maxWidth="Infinity"/>
             </VBox>
 
          </children>
       </StackPane>
    </center>
 </BorderPane>
